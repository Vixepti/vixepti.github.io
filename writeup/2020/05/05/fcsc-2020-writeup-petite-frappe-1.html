<!DOCTYPE html>
<html lang=" en "><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Writeup - FCSC-2020 - Intro - Petite Frappe 1 | Vixepti</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Writeup - FCSC-2020 - Intro - Petite Frappe 1" />
<meta name="author" content="Vixepti" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="J’ai pas mal hésité à publier ce writeup ainsi que celui pour le challenge Petite frappe 2, parce que j’ai flag vraiment salement. Mais finalement je publie avec pour objectif d’apporter une amélioration dans les prochains jours pour faire ça plus proprement. Ça soulagera ma conscience." />
<meta property="og:description" content="J’ai pas mal hésité à publier ce writeup ainsi que celui pour le challenge Petite frappe 2, parce que j’ai flag vraiment salement. Mais finalement je publie avec pour objectif d’apporter une amélioration dans les prochains jours pour faire ça plus proprement. Ça soulagera ma conscience." />
<link rel="canonical" href="https://vixepti.fr/writeup/2020/05/05/fcsc-2020-writeup-petite-frappe-1.html" />
<meta property="og:url" content="https://vixepti.fr/writeup/2020/05/05/fcsc-2020-writeup-petite-frappe-1.html" />
<meta property="og:site_name" content="Vixepti" />
<meta property="og:image" content="https://vixepti.fr/assets/2020/05/FCSC.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-05T19:00:04+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://vixepti.fr/assets/2020/05/FCSC.png" />
<meta property="twitter:title" content="Writeup - FCSC-2020 - Intro - Petite Frappe 1" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Vixepti"},"dateModified":"2020-05-05T19:00:04+02:00","datePublished":"2020-05-05T19:00:04+02:00","description":"J’ai pas mal hésité à publier ce writeup ainsi que celui pour le challenge Petite frappe 2, parce que j’ai flag vraiment salement. Mais finalement je publie avec pour objectif d’apporter une amélioration dans les prochains jours pour faire ça plus proprement. Ça soulagera ma conscience.","headline":"Writeup - FCSC-2020 - Intro - Petite Frappe 1","image":"https://vixepti.fr/assets/2020/05/FCSC.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://vixepti.fr/writeup/2020/05/05/fcsc-2020-writeup-petite-frappe-1.html"},"url":"https://vixepti.fr/writeup/2020/05/05/fcsc-2020-writeup-petite-frappe-1.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://vixepti.fr/feed.xml" title="Vixepti" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  /* global dataLayer */
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', '');
</script></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Vixepti</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">À propos</a><a class="page-link" href="/categories/">Catégories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
            <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Writeup - FCSC-2020 - Intro - Petite Frappe 1</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-05-05T19:00:04+02:00" itemprop="datePublished">May 5, 2020
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Vixepti</span></span></p>
      <hr>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>J’ai pas mal hésité à publier ce writeup ainsi que celui pour le challenge <a href="/writeup/2020/05/05/fcsc-2020-writeup-petite-frappe-2.html">Petite frappe 2</a>, parce que j’ai flag vraiment salement. Mais finalement je publie avec pour objectif d’apporter une amélioration dans les prochains jours pour faire ça plus proprement. Ça soulagera ma conscience.<!--more--></p>

<h1 id="énoncé">Énoncé</h1>

<blockquote>
  <p>Lors de l’investigation d’un poste GNU/Linux, vous analysez un fichier qui semble être généré par un programme d’enregistrement de frappes de clavier (enregistrement de l’activité de chaque touche utilisée).</p>

  <p>Retrouvez ce qui a bien pu être écrit par l’utilisateur de ce poste à l’aide de ce fichier !</p>

  <p>Format du flag : Pour valider ce challenge, vous devez insérer le contenu de ce qui a été écrit sur le clavier de ce poste dans la balise suivante <em>FCSC{xxxxxx}</em> puis soumettre votre réponse.</p>
</blockquote>

<h1 id="solution">Solution</h1>

<p>J’ai relevé chaque lettre de chaque <em>EV_KEY</em>. Exemple :</p>

<blockquote>
  <p>Event: time 1584656705.424839, ————– SYN_REPORT ————</p>

  <p>Event: time 1584656706.404214, type 4 (EV_MSC), code 4 (MSC_SCAN), value 16</p>

  <p>Event: time 1584656706.404214, type 1 (EV_KEY), code 22 (<strong>KEY_U</strong>), value 1</p>

  <p>Event: time 1584656706.404214, ————– SYN_REPORT ————</p>

  <p>Event: time 1584656706.508350, type 4 (EV_MSC), code 4 (MSC_SCAN), value 16</p>

  <p>Event: time 1584656706.508350, type 1 (EV_KEY), code 22 (<strong>KEY_U</strong>), value 0</p>

  <p>Event: time 1584656706.508350, ————– SYN_REPORT ————</p>

  <p>Event: time 1584656706.674591, type 4 (EV_MSC), code 4 (MSC_SCAN), value 31</p>

  <p>Event: time 1584656706.674591, type 1 (EV_KEY), code 49 (<strong>KEY_N</strong>), value 1</p>
</blockquote>

<p>Ça donne : <strong>UUN</strong></p>

<h1 id="flag">Flag</h1>

<p>Le flag est donc : <strong><em>FCSC{UNEGENTILLEINTRODUCTION}</em></strong></p>

<h1 id="edit">Edit</h1>

<p>Bon du coup, comme promis j’ai rapidement repris ce challenge plus proprement. J’utilise donc la commande <strong>awk</strong> :</p>

<figure class="highlight"><pre><code class="language-shell_session" data-lang="shell_session"><span class="gp">[vixepti@computer]$</span><span class="w"> </span><span class="nb">cat </span>petite_frappe_1.txt | <span class="nb">grep</span> <span class="s1">'EV_KEY'</span> | <span class="nb">awk</span> <span class="s1">'{if(NR % 2) print substr($9,6,1)}'</span> <span class="nv">ORS</span><span class="o">=</span><span class="s1">''</span>
<span class="go">UNEGENTILLEINTRODDCTION</span></code></pre></figure>

<p>Et pour mieux comprendre, je vais détailler :</p>

<ul>
  <li>J’affiche le contenu du fichier fournit :</li>
</ul>

<figure class="highlight"><pre><code class="language-shell_session" data-lang="shell_session"><span class="go">cat petite_frappe_1.txt</span></code></pre></figure>

<ul>
  <li>Je filtre sur la chaîne de caractères <em>EV_KEY</em> :</li>
</ul>

<figure class="highlight"><pre><code class="language-shell_session" data-lang="shell_session"><span class="go">| grep 'EV_KEY'</span></code></pre></figure>

<ul>
  <li>J’affiche uniquement une ligne sur deux (sinon je me retrouve avec chaque caractère en double) :</li>
</ul>

<figure class="highlight"><pre><code class="language-shell_session" data-lang="shell_session"><span class="go">| awk '{if(NR % 2)</span></code></pre></figure>

<ul>
  <li>J’affiche le 6<sup>ème</sup> caractère de la 9<sup>ème</sup> colonne (celle qui contient la touche clavier : KEY_?) :</li>
</ul>

<figure class="highlight"><pre><code class="language-shell_session" data-lang="shell_session"><span class="gp">print substr($</span>9,6,1<span class="o">)}</span><span class="s1">'</span></code></pre></figure>

<ul>
  <li>Et enfin, je supprime l’<em>output record separator</em> (par défaut : \n) pour avoir tous les caractères sur une seule ligne :</li>
</ul>

<figure class="highlight"><pre><code class="language-shell_session" data-lang="shell_session"><span class="go">ORS=''</span></code></pre></figure>

<p>C’était finalement pas si compliqué, j’aurai même gagné du temps je pense…</p>

  </div>

  
    <hr><br>
    <span>Tags :</span>
    <div class="tags">
      <ul>
        
          <li><span class="tag">FCSC</span></li>    
        
          <li><span class="tag">ctf</span></li>    
        
          <li><span class="tag">writeup</span></li>    
        
          <li><span class="tag">forensic</span></li>    
        
      </ul>
    </div>
  <a class="u-url" href="/writeup/2020/05/05/fcsc-2020-writeup-petite-frappe-1.html" hidden></a>

  
</article>

        </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Vixepti</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Vixepti</li><li><a class="u-email" href="mailto:contact@vixepti.fr">contact@vixepti.fr</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/vixepti"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">vixepti</span></a></li><li><a href="https://www.twitter.com/vixepti"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">vixepti</span></a></li><li><a href="https://youtube.com/vixepti"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg> <span class="username">vixepti</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Administration systèmes et réseaux, Sécurité informatique, Hacking, Bricolage et autres joyeusetés...</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>