<!DOCTYPE html>
<html lang=" en "><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Writeup - FCSC-2020 - Web - Enter The Dungeon | Vixepti</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Writeup - FCSC-2020 - Web - Enter The Dungeon" />
<meta name="author" content="Vixepti" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hello, ceci est mon writeup pour le challenge Enter The Dungeon du France Cybersecurity Challenge 2020. J’ai passé un sacré moment dessus (je ne suis pas du tout expériementé dans le domaine du web), ça méritait bien un writeup." />
<meta property="og:description" content="Hello, ceci est mon writeup pour le challenge Enter The Dungeon du France Cybersecurity Challenge 2020. J’ai passé un sacré moment dessus (je ne suis pas du tout expériementé dans le domaine du web), ça méritait bien un writeup." />
<link rel="canonical" href="http://localhost:4000/writeup/2020/05/05/fcsc-2020-writeup-enter-the-dungeon.html" />
<meta property="og:url" content="http://localhost:4000/writeup/2020/05/05/fcsc-2020-writeup-enter-the-dungeon.html" />
<meta property="og:site_name" content="Vixepti" />
<meta property="og:image" content="http://localhost:4000/assets/2020/05/FCSC.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-05T19:00:12+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/2020/05/FCSC.png" />
<meta property="twitter:title" content="Writeup - FCSC-2020 - Web - Enter The Dungeon" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Vixepti"},"dateModified":"2020-05-05T19:00:12+02:00","datePublished":"2020-05-05T19:00:12+02:00","description":"Hello, ceci est mon writeup pour le challenge Enter The Dungeon du France Cybersecurity Challenge 2020. J’ai passé un sacré moment dessus (je ne suis pas du tout expériementé dans le domaine du web), ça méritait bien un writeup.","headline":"Writeup - FCSC-2020 - Web - Enter The Dungeon","image":"http://localhost:4000/assets/2020/05/FCSC.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/writeup/2020/05/05/fcsc-2020-writeup-enter-the-dungeon.html"},"url":"http://localhost:4000/writeup/2020/05/05/fcsc-2020-writeup-enter-the-dungeon.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Vixepti" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Vixepti</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">À propos</a><a class="page-link" href="/categories/">Catégories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
            <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Writeup - FCSC-2020 - Web - Enter The Dungeon</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-05-05T19:00:12+02:00" itemprop="datePublished">May 5, 2020
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Vixepti</span></span></p>
      <hr>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Hello, ceci est mon writeup pour le challenge <em>Enter The Dungeon</em> du <em>France Cybersecurity Challenge 2020</em>. J’ai passé un sacré moment dessus (je ne suis pas du tout expériementé dans le domaine du web), ça méritait bien un writeup.<!--more--></p>

<h1 id="énoncé">Énoncé</h1>
<blockquote>
  <p>On vous demande simplement de trouver le flag.</p>

  <p>URL : http://challenges2.france-cybersecurity-challenge.fr:5002/</p>
</blockquote>

<p>On a la page web suivante :</p>

<p style="text-align: center;"><img src="/assets/2020/05/EnterTheDungeon-home.png" alt="Enter The Dungeon - Homepage" /></p>

<h1 id="solution">Solution</h1>

<h2 id="ctrl--u">CTRL + U</h2>
<p>Première étape d’un challenge web, consulter le code source de la page :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
	<span class="nt">&lt;title&gt;</span>Enter The Dungeon<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">style=</span><span class="s">"background-color:#3CB371;"</span><span class="nt">&gt;</span>
<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Enter The Dungeon<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
The flag is hidden into the dungeon ! You should come here as the <span class="nt">&lt;b&gt;</span>dungeon_master<span class="nt">&lt;/b&gt;</span> to be able to open the gate and access the treasure.<span class="nt">&lt;br</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>

<span class="c">&lt;!-- Pour les admins : si vous pouvez valider les changements que j'ai fait dans la page "check_secret.php", le code est accessible sur le fichier "check_secret.txt" --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"font-size:85%;color:purple"</span><span class="nt">&gt;&lt;i&gt;</span>Les admins ont reçu un message indiquant qu'un pirate avait retrouvé le secret en contournant la sécurité du site. <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>Pour cette raison, le formulaire de vérification n'est plus fonctionnel tant que le développeur n'aura pas corrigé la vulnérabilité<span class="nt">&lt;/i&gt;&lt;/div&gt;&lt;br</span> <span class="nt">/&gt;</span></code></pre></figure>

<p>Ici, on remarque très clairement le commentaire :</p>

<blockquote>
  <p>Pour les admins : si vous pouvez valider les changements que j’ai fait dans la page “check_secret.php”, le code est accessible sur le fichier “check_secret.txt”</p>
</blockquote>

<p>Il y a donc un fichier <em>check_secret.txt</em> contenant :</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
	<span class="nb">session_start</span><span class="p">();</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'dungeon_master'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
	<span class="nt">&lt;title&gt;</span>Enter The Dungeon<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">style=</span><span class="s">"background-color:#3CB371;"</span><span class="nt">&gt;</span>
<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Enter The Dungeon<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="cp">&lt;?php</span>
	<span class="k">echo</span> <span class="s1">'&lt;div style="font-size:85%;color:purple"&gt;For security reason, secret check is disable !&lt;/div&gt;&lt;br /&gt;'</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s1">'&lt;pre&gt;'</span><span class="mf">.</span><span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
	<span class="k">include</span><span class="p">(</span><span class="s1">'./ecsc.txt'</span><span class="p">);</span>
	<span class="k">echo</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="mf">.</span><span class="s1">'&lt;/pre&gt;'</span><span class="p">;</span>

	<span class="c1">// authentication is replaced by an impossible test</span>
	<span class="c1">//if(md5($_GET['secret']) == "a5de2c87ba651432365a5efd928ee8f2")</span>
	<span class="k">if</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'secret'</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'secret'</span><span class="p">])</span>
	<span class="p">{</span>
		<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'dungeon_master'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">echo</span> <span class="s2">"Secret is correct, welcome Master ! You can now enter the dungeon"</span><span class="p">;</span>
		
	<span class="p">}</span>
	<span class="k">else</span>
	<span class="p">{</span>
		<span class="k">echo</span> <span class="s2">"Wrong secret !"</span><span class="p">;</span>
	<span class="p">}</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;/body&gt;&lt;/html&gt;</span></code></pre></figure>

<p>Bon c’est donc le système de login utilisé pour accéder au “Donjon”.</p>

<h2 id="recherches-infructueuses">Recherches infructueuses</h2>

<p>Je me suis d’abord penché sur le hash md5 qui se situe dans les commentaires : a5de2c87ba651432365a5efd928ee8f2</p>

<ol>
  <li>J’ai essayé de chercher si la chaine de caractère correspondante existe dans les bases de données de plusieurs sites :
    <ul>
      <li><a href="https://md5decrypt.net/en/">md5decrypt</a></li>
      <li><a href="https://md5hashing.net/hash/md5">md5hashing</a></li>
    </ul>
  </li>
  <li>J’ai essayé de retouver le hash depuis plusieurs chaines de caractères probables. En fait, j’ai été induit en erreur par la phrase présente sur la page d’accueil :</li>
</ol>

<blockquote>
  <p>You should come here as the dungeon_master to be able to open the gate and access the treasure.</p>
</blockquote>

<p>Je me suis dis que l’on pouvait peut être obtenir le hash en utilisant md5 sur :</p>

<ul>
  <li>dungeon_master</li>
  <li>dungeon_master=1</li>
  <li>master of the dungeon</li>
  <li>dragon (ouais, D&amp;D, tu connais..)</li>
  <li>…</li>
</ul>

<p>J’ai essayé pas mal de chaînes de caractères mais bien évidemment je n’ai pas trouvé.</p>

<ol>
  <li>J’ai également essayé de cracker le hash avec hashcat. J’ai laissé tourner une heure puis j’ai arrêté. Si c’était trouvable par ce moyen, j’aurai déjà eu un résultat.</li>
</ol>

<h2 id="magic-hashes">Magic Hashes</h2>

<p>En continuant à chercher, j’ai finis par découvrir les magic hashes. Ce sont couples chaines de caractère/hash dont la valeur du md5 commence par “0e”. C’est intéressant car en PHP la comparaison avec == au lieu de === va vérifier uniquement le type au lieu de comparer ces valeurs. Or, la chaine commençant par 0e en PHP sera reconnu comme une notation scientifique, il faut donc trouver une valeur commençant par 0e et dont le hash md5 commence également par 0e.</p>

<p>Et on a de la chance cette valeur existe : <strong>0e215962017</strong> a pour hash md5 <strong>0e291242476940776845150308577824</strong>.</p>

<p>On entre donc cette valeur dans le formulaire et on a le résultat suivant :</p>

<p style="text-align: center;"><img src="/assets/2020/05/EnterTheDungeon-welcome.png" alt="Enter The Dungeon - Homepage" /></p>

<p>On peut ensuite retourner sur la page d’accueil :</p>

<p style="text-align: center;"><img src="/assets/2020/05/EnterTheDungeon-flag.png" alt="Enter The Dungeon - Homepage" /></p>

<h1 id="flag">Flag</h1>

<p>Le flag est donc : <strong><em>FCSC{f67aaeb3b15152b216cb1addbf0236c66f9d81c4487c4db813c1de8603bb2b5b}</em></strong></p>

  </div>

  
    <hr><br>
    <span>Tags :</span>
    <div class="tags">
      <ul>
        
          <li><span class="tag">FCSC</span></li>    
        
          <li><span class="tag">web</span></li>    
        
          <li><span class="tag">ctf</span></li>    
        
          <li><span class="tag">writeup</span></li>    
        
      </ul>
    </div>
  <a class="u-url" href="/writeup/2020/05/05/fcsc-2020-writeup-enter-the-dungeon.html" hidden></a>

  
</article>

        </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Vixepti</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Vixepti</li><li><a class="u-email" href="mailto:contact@vixepti.fr">contact@vixepti.fr</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/vixepti"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">vixepti</span></a></li><li><a href="https://www.twitter.com/vixepti"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">vixepti</span></a></li><li><a href="https://youtube.com/vixepti"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg> <span class="username">vixepti</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Administration systèmes et réseaux, Sécurité informatique, Hacking, Bricolage et autres joyeusetés...</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>